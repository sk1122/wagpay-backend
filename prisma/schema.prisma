generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum CURRENCY {
  solana
  ethereum
  usdcsol
  usdceth
}

model User {
  id          String    @id @default(uuid())
  username    String?
  eth_address String?
  sol_address String?
  is_paid     Boolean?
  created_at  DateTime  @default(now())
  email       String?
  Pages       Pages[]
  Product     Product[]
}

model Product {
  id               Int          @id @default(autoincrement())
  discounted_price Float
  name             String
  description      String?
  links            String[]
  sold             Int          @default(0)
  created_at       DateTime     @default(now())
  price            Float
  page             Pages[]
  userId           String
  user             User         @relation(fields: [userId], references: [id])
  Submission       Submission[]
}

model Pages {
  id                  Int          @id @default(autoincrement())
  fields              Json[]
  created_at          DateTime     @default(now())
  title               String
  logo                String?
  description         String?
  social_links        Json?
  accepted_currencies CURRENCY[]
  terms_conditions    String[]
  slug                String
  eth_address         String?
  sol_address         String?
  visits              Int
  userId              String
  user                User         @relation(fields: [userId], references: [id])
  submissions         Submission[]
  products            Product[] 
  payment_intents     PaymentIntent[]
}

model Submission {
  id               Int      @id @default(autoincrement())
  created_at       DateTime @default(now())
  name             String?
  fields           Json[]
  contact_number   String?
  email            String?
  eth_address      String?
  sol_address      String?
  currency         CURRENCY
  pagesId          Int
  productId        Int
  transaction_hash String?
  page             Pages    @relation(fields: [pagesId], references: [id])
  products         Product[]
}

model PaymentIntent {
  id               String    @id @default(uuid())
  value            Int
  transaction_hash String
  is_paid          Boolean @default(false)
  pagesId          Int
  page             Pages    @relation(fields: [pagesId], references: [id]) 
  from_email       String
  currency         CURRENCY[]
  created_at       DateTime @default(now())
}